<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Francia Ramírez | Transcripción Profesional de Actas</title>

  <meta name="description" content="Especialista en transcripción profesional de actas de asamblea y consejos de administración. Precisión jurídica, confidencialidad y entrega oportuna en Colombia.">
  <meta name="keywords" content="transcripción profesional, actas asamblea, consejos de administración, propiedad horizontal, Cali, Colombia, servicio confiable">
  <meta name="author" content="Francia Ramírez">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <style>
    /* --- Estilos base --- */
    :root {
      --color-principal: #1e2a38;
      --color-acento: #d4af37;
      --color-fondo: #fdfaf7;
      --color-texto: #2c2c2c;
      --altura-promo: 35px;
    }
    body {
      font-family: 'Georgia', serif;
      margin: 0;
      background-color: var(--color-fondo);
      color: var(--color-texto);
      padding-top: var(--altura-promo);
      line-height: 1.6;
    }
    h2, h3 { color: var(--color-principal); }
    .barra-promocion {
      position: fixed; top: 0; left: 0; width: 100%; height: var(--altura-promo);
      background-color: var(--color-acento); color: var(--color-principal);
      text-align: center; line-height: var(--altura-promo); font-size: 0.95rem;
      font-weight: bold; z-index: 200; text-decoration: none;
    }
    .barra-promocion i { margin-right: 8px; animation: pulse 1.5s infinite; }
    @keyframes pulse { 0%{transform:scale(1)}50%{transform:scale(1.05)}100%{transform:scale(1)} }
    header {
      background: linear-gradient(90deg, var(--color-principal) 0%, #24384e 100%);
      padding: 15px 40px; color: white; position: sticky;
      top: var(--altura-promo); z-index: 100; display: flex; justify-content: space-between; align-items: center;
    }
    header img { height: 55px; border-radius: 50%; }
    header h1 { margin: 0; font-size: 1.8rem; color: var(--color-acento); }
    nav a { color: white; text-decoration: none; margin: 0 15px; font-size: 1.1rem; }
    nav a:hover { color: var(--color-acento); }
    .btn-cotizar {
      background-color: var(--color-acento); color: var(--color-principal);
      padding: 15px 35px; border-radius: 30px; font-weight: bold; text-decoration: none;
      display: inline-block; margin-top: 35px; box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }
    .btn-cotizar:hover { background-color: #c09c32; }

    /* --- Modal de cotización --- */
    .modal {
      display: none; position: fixed; z-index: 200; left: 0; top: 0; width: 100%; height: 100%;
      background-color: rgba(0,0,0,0.5); overflow-y: auto; padding-top: 20px;
    }
    .modal-contenido {
      background-color: #fff; margin: 5% auto; padding: 20px; border-radius: 10px;
      width: 90%; max-width: 750px; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
      position: relative;
    }
    .cerrar { float: right; font-size: 35px; color: #aaa; cursor: pointer; }
    .cerrar:hover { color: var(--color-principal); }

    /* --- Formulario --- */
    .form-cotizacion-container label { display:block; margin-top:10px; font-weight:bold; color:#3a2f1f; font-size:14px; }
    .form-cotizacion-container input, .form-cotizacion-container select {
      width:100%; padding:10px; border:1px solid #c5a05a; border-radius:6px; margin-top:4px; font-size:14px;
    }
    .valor { text-align:center; margin-top:15px; font-weight:bold; color:#3a2f1f; }
    .mensaje-confirmacion {
      display:none;
      background:#d4af37;
      color:#1e2a38;
      font-weight:bold;
      text-align:center;
      padding:10px;
      border-radius:6px;
      margin-top:15px;
      animation: fadeIn 0.5s ease-in-out;
    }
    @keyframes fadeIn {
      from { opacity:0; transform:translateY(-10px); }
      to { opacity:1; transform:translateY(0); }
    }
  </style>
</head>

<body>
  <a href="https://linktr.ee/TranscripcionProfesionalFFRR" class="barra-promocion" target="_blank">
    <i class="fas fa-star"></i> ¡PROMOCIONES DEL MES! HAZ CLIC AQUÍ <i class="fas fa-star"></i>
  </a>

  <header>
    <div class="logo-box">
      <img src="logo_francia.jpg" alt="Logo circular dorado con iniciales FR, de Francia Ramírez">
      <h1>Francia Ramírez</h1>
    </div>
    <nav>
      <a href="#inicio">Inicio</a>
      <a href="#" id="abrirModal">Cotización</a>
    </nav>
  </header>

  <section class="hero" id="inicio" style="text-align:center; padding:60px 20px;">
    <h2>La Precisión Jurídica que sus Actas Requieren</h2>
    <a href="#" id="abrirModalCTA" class="btn-cotizar">Solicite su Cotización al Instante</a>
  </section>

  <div id="modalCotizacion" class="modal">
    <div class="modal-contenido">
      <span class="cerrar" id="cerrarModal">&times;</span>
      <div class="form-cotizacion-container">
        <h1>Formulario de Cotización</h1>
        <form id="cotizacionForm">
          <label>Nombre completo *</label>
          <input type="text" id="nombre" required>
          <label>Correo electrónico *</label>
          <input type="email" id="correo" required>
          <label>Teléfono *</label>
          <input type="tel" id="telefono" required>
          <label>Horas *</label>
          <input type="number" id="horas" min="0" required>
          <label>Minutos *</label>
          <input type="number" id="minutos" min="0" max="59" required>
          <div class="valor" id="resultado"></div>
          <button type="button" onclick="descargarYGuardarPDF()">Descargar cotización PDF</button>
        </form>
        <div id="mensajeConfirmacion" class="mensaje-confirmacion">✅ Registro guardado con éxito</div>
      </div>
    </div>
  </div>

  <script>
    // === Modal ===
    const modal = document.getElementById("modalCotizacion");
    document.getElementById("abrirModal").onclick = () => modal.style.display = "block";
    document.getElementById("abrirModalCTA").onclick = () => modal.style.display = "block";
    document.getElementById("cerrarModal").onclick = () => modal.style.display = "none";
    window.onclick = (e) => { if (e.target === modal) modal.style.display = "none"; };

    // === Validación ===
    function validarCampos() {
      const campos = ["nombre","correo","telefono","horas","minutos"];
      for (let id of campos) {
        if (!document.getElementById(id).value.trim()) {
          alert("Por favor complete todos los campos obligatorios.");
          return false;
        }
      }
      return true;
    }

    // === Calcular valor ===
    function calcularValor() {
      const horas = parseFloat(document.getElementById("horas").value) || 0;
      const minutos = parseFloat(document.getElementById("minutos").value) || 0;
      const total = horas + minutos / 60;
      let valor = 0;
      if (total <= 1) valor = 39000;
      else if (total <= 3) valor = 95000;
      else valor = 95000 + Math.ceil((total - 3) / 0.5) * 10000;
      document.getElementById("resultado").innerText = `Valor estimado: $${valor.toLocaleString("es-CO")}`;
      return valor;
    }

    // === Guardar en CRM ===
    async function guardarRegistro(valor) {
      const data = {
        nombre: document.getElementById("nombre").value,
        correo: document.getElementById("correo").value,
        telefono: document.getElementById("telefono").value,
        horas: document.getElementById("horas").value,
        minutos: document.getElementById("minutos").value,
        valor
      };
      try {
        const respuesta = await fetch("https://script.google.com/macros/s/AKfycby0P0RstlnWzxFFrWMsX1sWF8w2DegPYt4GFBAZjqsCrQsJFQzoxQlIgscuHu8RYlxz/exec", {
          method: "POST",
          body: JSON.stringify(data),
          headers: { "Content-Type": "application/json" }
        });
        if (respuesta.ok) {
          const mensaje = document.getElementById("mensajeConfirmacion");
          mensaje.style.display = "block";
          setTimeout(() => mensaje.style.display = "none", 4000);
        }
      } catch (e) {
        console.error("Error al guardar en el CRM:", e);
      }
    }

    // === Descargar PDF y guardar registro ===
    async function descargarYGuardarPDF() {
      if (!validarCampos()) return;
      const valor = calcularValor();
      await guardarRegistro(valor);

      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.text("COTIZACIÓN DE SERVICIO", 20, 20);
      doc.text(`Nombre: ${document.getElementById("nombre").value}`, 20, 40);
      doc.text(`Correo: ${document.getElementById("correo").value}`, 20, 50);
      doc.text(`Teléfono: ${document.getElementById("telefono").value}`, 20, 60);
      doc.text(`Duración: ${document.getElementById("horas").value}h ${document.getElementById("minutos").value}min`, 20, 70);
      doc.text(`Valor estimado: $${valor.toLocaleString("es-CO")}`, 20, 90);
      doc.save(`Cotizacion_${document.getElementById("nombre").value.replace(/\s/g, '_')}.pdf`);
    }
  </script>
</body>
</html>
